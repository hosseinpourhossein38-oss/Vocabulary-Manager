*** Begin Patch
*** Update File: app.py
@@
-from flask import Flask, Response, flash, redirect, render_template, request, session, url_for
-from werkzeug.utils import secure_filename
+from flask import Flask, Response, flash, redirect, render_template, request, session, url_for
+from flask_login import (
+    LoginManager,
+    UserMixin,
+    current_user,
+    login_required,
+    login_user,
+    logout_user,
+)
+from werkzeug.security import check_password_hash
+from werkzeug.utils import secure_filename
@@
-app = Flask(__name__)
-app.secret_key = os.environ.get("FLASK_SECRET_KEY", "dev-secret-change-me")
+app = Flask(__name__)
+app.secret_key = os.environ.get("FLASK_SECRET_KEY", "dev-secret-change-me")
+
+ADMIN_EMAIL = os.environ.get("ADMIN_EMAIL", "")
+ADMIN_HASH = os.environ.get("ADMIN_HASH", "")
+
+login_manager = LoginManager(app)
+login_manager.login_view = "login"
+login_manager.login_message_category = "warning"
+
+
+class AdminUser(UserMixin):
+    def __init__(self, email: str) -> None:
+        self._email = email
+
+    def get_id(self) -> str:
+        return self._email
+
+
+def get_admin_user() -> AdminUser | None:
+    if ADMIN_EMAIL:
+        return AdminUser(ADMIN_EMAIL)
+    return None
+
+
+@login_manager.user_loader
+def load_user(user_id: str) -> AdminUser | None:
+    if user_id == ADMIN_EMAIL and ADMIN_EMAIL:
+        return AdminUser(user_id)
+    return None
*** End Patch
